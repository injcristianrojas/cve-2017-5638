/*

For this to work, first do the following:
* Define a Maven installation called M3.
* Install the OWASP Dependency Check Plugin.

*/

node {
    def mvnHome
    stage('Preparation') { // for display purposes
        git 'https://github.com/injcristianrojas/cve-2017-5638.git'
        mvnHome = tool 'M3'
    }
    stage('Check') {
        withEnv(["MVN_HOME=$mvnHome"]) {
            sh '"$MVN_HOME/bin/mvn" -Dformat=XML org.owasp:dependency-check-maven:check'
        }
    }
    stage('Results') {
        dependencyCheckPublisher()
    }
}